<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JL Acessórios - Portal Unificado</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --preto: #181818;
            --vermelho: #e53935;
            --azul: #00e0ff;
            --roxo: #7c3aed;
            --branco: #fff;
            --cinza-escuro: #23272b;
            --cinza-claro: #f5f5f5;
            --neon: #00e0ff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', Arial, sans-serif;
            background: var(--preto);
            color: var(--branco);
            min-height: 100vh;
            display: flex;
        }

        /* Sidebar */
        .sidebar {
            width: 250px;
            background: var(--cinza-escuro);
            padding: 20px 0;
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 20px;
        }

        .sidebar-header h1 {
            color: var(--neon);
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            text-align: center;
            margin-bottom: 10px;
        }

        .user-info {
            text-align: center;
            margin-bottom: 20px;
        }

        .user-info .user-name {
            font-weight: bold;
            color: var(--neon);
        }

        .user-info .user-role {
            font-size: 0.8rem;
            color: var(--branco);
            opacity: 0.7;
        }

        .sidebar-menu {
            flex: 1;
        }

        .menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--branco);
            text-decoration: none;
            transition: all 0.3s;
            cursor: pointer;
        }

        .menu-item:hover {
            background: rgba(0,224,255,0.1);
            color: var(--neon);
        }

        .menu-item.active {
            background: var(--neon);
            color: var(--preto);
        }

        .menu-item i {
            width: 20px;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            margin-left: 250px;
            padding: 20px;
            flex: 1;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .page-title {
            color: var(--neon);
            font-size: 1.5rem;
        }

        /* Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .dashboard-row {
            display: flex;
            gap: 20px;
            margin-bottom: 24px;
        }

        .dashboard-col {
            flex: 1;
            min-width: 0;
        }

        .section-card {
            background: var(--cinza-escuro);
            border-radius: 8px;
            padding: 20px;
            height: 100%;
        }

        .section-card.full-width {
            width: 100%;
        }

        .metric-card {
            background: var(--cinza-escuro);
            border-radius: 8px;
            padding: 20px;
            transition: transform 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--neon);
            margin: 10px 0;
        }

        .metric-details {
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .metric-split {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            color: var(--branco);
        }

        .rating-stars {
            color: var(--neon);
            font-size: 1.2rem;
            margin: 5px 0;
        }

        .rating-count {
            color: var(--branco);
            font-size: 0.9rem;
        }

        .service-item, .sale-item {
            background: var(--preto);
            border-radius: 4px;
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .service-info, .sale-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .service-actions {
            display: flex;
            gap: 8px;
        }

        .sale-meta {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 4px;
            font-size: 0.9rem;
        }

        .sale-type {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }

        .sale-type.online {
            background: var(--neon);
            color: var(--preto);
        }

        .sale-type.local {
            background: var(--cinza-escuro);
            color: var(--branco);
        }

        .empty-state {
            color: var(--cinza);
            text-align: center;
            padding: 20px;
            font-style: italic;
        }

        /* PDV Styles */
        .pdv-container {
            display: flex;
            gap: 24px;
            height: calc(100vh - 100px);
        }

        .pdv-main {
            flex: 2;
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
        }

        .pdv-sidebar {
            flex: 1;
            min-width: 300px;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .sales-type-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .sales-type-toggle .btn {
            flex: 1;
            text-align: center;
            padding: 12px;
            background: var(--cinza-escuro);
            border: 1px solid transparent;
            transition: all 0.3s ease;
        }

        .sales-type-toggle .btn.active {
            background: var(--preto);
            border-color: var(--neon);
            color: var(--neon);
        }

        .search-wrapper {
            position: relative;
        }

        .search-filters {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .search-filters select {
            flex: 1;
            padding: 8px;
            background: var(--preto);
            border: 1px solid var(--cinza-escuro);
            color: var(--branco);
            border-radius: 4px;
        }

        .customer-search {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .customer-search .search-input {
            flex: 1;
        }

        .customer-history {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--cinza-escuro);
        }

        .cart-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .cart-summary {
            background: var(--preto);
            padding: 15px;
            border-radius: 4px;
        }

        .cart-summary > div {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .cart-summary .total {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--neon);
            border-top: 1px solid var(--cinza-escuro);
            padding-top: 10px;
            margin-top: 10px;
        }

        .discount-input {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .discount-input input {
            width: 60px;
            padding: 4px;
            background: var(--preto);
            border: 1px solid var(--cinza-escuro);
            color: var(--branco);
            border-radius: 4px;
        }

        .payment-section {
            background: var(--preto);
            padding: 15px;
            border-radius: 4px;
        }

        .payment-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .payment-options .btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            padding: 10px;
        }

        .payment-options .btn i {
            font-size: 1.2em;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: var(--cinza-escuro);
            padding: 24px;
            border-radius: 8px;
            width: 100%;
            max-width: 500px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--branco);
        }

        .form-group input {
            width: 100%;
            padding: 8px;
            background: var(--preto);
            border: 1px solid var(--cinza-escuro);
            color: var(--branco);
            border-radius: 4px;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        /* Sistema de Notificações */
        .notifications-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            width: 300px;
        }

        .notification {
            background: var(--cinza-escuro);
            border-left: 4px solid var(--neon);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        /* Produtos */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .product-card {
            background: var(--cinza-escuro);
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.2s;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-image {
            height: 200px;
            background: var(--preto);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-info {
            padding: 15px;
        }

        .product-title {
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .product-price {
            color: var(--neon);
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        /* Carrinho */
        .cart-sidebar {
            position: fixed;
            right: 0;
            top: 0;
            width: 350px;
            height: 100vh;
            background: var(--cinza-escuro);
            padding: 20px;
            box-shadow: -2px 0 8px rgba(0,0,0,0.2);
            transform: translateX(100%);
            transition: transform 0.3s;
        }

        .cart-sidebar.open {
            transform: translateX(0);
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .cart-items {
            max-height: calc(100vh - 200px);
            overflow-y: auto;
        }

        .cart-item {
            display: flex;
            gap: 10px;
            padding: 10px;
            background: var(--preto);
            border-radius: 4px;
            margin-bottom: 10px;
        }

        .cart-summary {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 20px;
        }

        /* Sistema de Pagamento */
        .payment-settings {
            background: var(--cinza-escuro);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .installment-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .installment-option {
            background: var(--preto);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--neon);
        }

        .installment-option h4 {
            color: var(--neon);
            margin-bottom: 10px;
        }

        /* Programa de Fidelidade */
        .loyalty-program {
            background: var(--cinza-escuro);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .points-system {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .points-card {
            background: var(--preto);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--neon);
        }

        .points-value {
            font-size: 1.5rem;
            color: var(--neon);
            font-weight: bold;
        }

        /* Animações */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Estilos para Comissões */
        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
            padding: 20px;
            background: var(--preto);
            border-radius: 8px;
        }

        .summary-item {
            text-align: center;
            padding: 15px;
            background: var(--cinza-escuro);
            border-radius: 8px;
            border: 1px solid var(--neon);
        }

        .summary-item span {
            display: block;
            color: var(--cinza);
            margin-bottom: 5px;
        }

        .summary-item strong {
            color: var(--neon);
            font-size: 1.2rem;
        }

        .status {
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .status.pending {
            background: #ff9800;
            color: #000;
        }

        .status.paid {
            background: #4caf50;
            color: #fff;
        }

        /* Estilos para Pontos de Fidelidade */
        .points-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .points-details {
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            color: var(--cinza);
        }

        .points-details span {
            font-size: 0.9rem;
        }

        /* Animações */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .metric-card, .points-card, .summary-item {
            animation: fadeIn 0.3s ease-out;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .sidebar {
                width: 0;
                overflow: hidden;
            }

            .sidebar.open {
                width: 250px;
            }

            .main-content {
                margin-left: 0;
            }

            .pdv-container {
                grid-template-columns: 1fr;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .installment-options {
                grid-template-columns: 1fr;
            }

            .points-system {
                grid-template-columns: 1fr;
            }

            .summary {
                grid-template-columns: 1fr;
            }

            .points-summary {
                grid-template-columns: 1fr;
            }

            .table-container {
                overflow-x: auto;
            }
        }

        /* Estilos da Loja Online */
        .store-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .store-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .search-section {
            display: flex;
            gap: 20px;
            flex: 1;
            margin-right: 20px;
        }

        .search-bar {
            position: relative;
            flex: 1;
        }

        .search-bar input {
            width: 100%;
            padding: 12px 40px 12px 20px;
            border-radius: 25px;
            border: 2px solid var(--neon);
            background: var(--preto);
            color: var(--branco);
            font-size: 1rem;
        }

        .search-bar i {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--neon);
        }

        .category-filter select {
            padding: 12px 20px;
            border-radius: 25px;
            border: 2px solid var(--neon);
            background: var(--preto);
            color: var(--branco);
            font-size: 1rem;
            cursor: pointer;
        }

        .cart-preview {
            position: relative;
            cursor: pointer;
            padding: 10px;
        }

        .cart-count {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--vermelho);
            color: var(--branco);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .featured-products {
            margin-bottom: 40px;
        }

        .featured-slider {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding: 20px 0;
            scrollbar-width: none;
        }

        .featured-slider::-webkit-scrollbar {
            display: none;
        }

        .featured-product {
            min-width: 300px;
            background: var(--cinza-escuro);
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s;
        }

        .featured-product:hover {
            transform: translateY(-5px);
        }

        .featured-product .product-image {
            height: 200px;
            overflow: hidden;
        }

        .featured-product .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .featured-product .product-info {
            padding: 20px;
        }

        .featured-product .product-info h3 {
            margin-bottom: 10px;
            color: var(--branco);
        }

        .featured-product .product-info .price {
            font-size: 1.2rem;
            color: var(--neon);
            margin-bottom: 15px;
        }

        .section-nav {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }

        .section-btn {
            background: none;
            border: none;
            color: var(--branco);
            cursor: pointer;
            padding: 10px 20px;
            border-radius: 20px;
            transition: all 0.3s;
        }

        .section-btn.active {
            background: var(--neon);
            color: var(--preto);
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .product-card {
            position: relative;
            background: var(--cinza-escuro);
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,224,255,0.2);
        }

        .product-badges {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 2;
            display: flex;
            gap: 5px;
        }

        .badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .badge.new {
            background: var(--neon);
            color: var(--preto);
        }

        .badge.sale {
            background: var(--vermelho);
            color: var(--branco);
        }

        .product-actions {
            position: absolute;
            right: 10px;
            top: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.3s;
        }

        .product-card:hover .product-actions {
            opacity: 1;
            transform: translateX(0);
        }

        .action-btn {
            background: var(--preto);
            color: var(--neon);
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .action-btn:hover {
            background: var(--neon);
            color: var(--preto);
        }

        .product-category {
            color: var(--neon);
            font-size: 0.8rem;
            margin-bottom: 5px;
        }

        .product-title {
            margin: 5px 0;
            font-size: 1.1rem;
            color: var(--branco);
        }

        .product-rating {
            color: #ffc107;
            margin: 5px 0;
        }

        .product-rating span {
            color: var(--branco);
            margin-left: 5px;
        }

        .product-price {
            margin: 10px 0;
        }

        .original-price {
            color: var(--branco);
            text-decoration: line-through;
            margin-right: 10px;
            opacity: 0.7;
        }

        .final-price {
            color: var(--neon);
            font-size: 1.2rem;
            font-weight: bold;
        }

        .product-installments {
            font-size: 0.9rem;
            color: var(--branco);
            opacity: 0.8;
            margin-bottom: 10px;
        }

        .add-to-cart {
            width: 100%;
            padding: 10px;
            background: var(--neon);
            color: var(--preto);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .add-to-cart:hover {
            background: var(--preto);
            color: var(--neon);
        }

        /* Modal do Carrinho */
        .cart-modal {
            display: none;
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
        }

        .cart-content {
            position: absolute;
            top: 0;
            right: 0;
            width: 400px;
            height: 100%;
            background: var(--cinza-escuro);
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-btn {
            background: none;
            border: none;
            color: var(--branco);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .cart-items {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .cart-item {
            display: flex;
            gap: 10px;
            padding: 10px;
            background: var(--preto);
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .item-info {
            flex: 1;
        }

        .item-actions {
            display: flex;
            gap: 5px;
        }

        .cart-summary {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 20px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .summary-item.total {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--neon);
        }

        .cart-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        /* Modal de Checkout */
        .checkout-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
        }

        .checkout-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            background: var(--cinza-escuro);
            padding: 20px;
            border-radius: 10px;
            overflow-y: auto;
        }

        .checkout-steps {
            margin-top: 20px;
        }

        .step {
            display: none;
        }

        .step.active {
            display: block;
        }

        .payment-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .payment-option {
            background: var(--preto);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .payment-option:hover {
            background: var(--neon);
            color: var(--preto);
        }

        .payment-option i {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--branco);
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid var(--preto);
            background: var(--preto);
            color: var(--branco);
        }

        .order-summary {
            background: var(--preto);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .order-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--neon);
            color: var(--preto);
        }

        .btn-primary:hover {
            background: var(--preto);
            color: var(--neon);
        }

        @media (max-width: 768px) {
            .store-header {
                flex-direction: column;
                gap: 20px;
            }

            .search-section {
                width: 100%;
                margin-right: 0;
            }

            .cart-content {
                width: 100%;
            }

            .checkout-content {
                width: 95%;
                padding: 15px;
            }

            .payment-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <h1>JL Acessórios</h1>
            <div class="user-info">
                <div class="user-name" id="userName">Carregando...</div>
                <div class="user-role" id="userRole">Carregando...</div>
            </div>
        </div>
        <div class="sidebar-menu" id="sidebarMenu">
            <!-- Menu items serão inseridos dinamicamente -->
        </div>
        <div class="menu-item" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i>
            Sair
        </div>
    </div>

    <div class="main-content">
        <div class="page-header">
            <h2 class="page-title" id="pageTitle">Dashboard</h2>
            <div id="headerActions"></div>
        </div>
        <div id="content">
            <!-- Conteúdo será inserido dinamicamente -->
        </div>
    </div>

    <div class="notifications-container" id="notifications"></div>

    <script>
        // Verificação de autenticação
        function checkAuth() {
            const user = JSON.parse(sessionStorage.getItem('usuarioLogado'));
            if (!user) {
                window.location.href = 'index.html';
                return;
            }
            return user;
        }

        // Carregar informações do usuário
        function loadUserInfo() {
            const user = checkAuth();
            if (!user) return;

            document.getElementById('userName').textContent = user.nome;
            document.getElementById('userRole').textContent = user.tipo === 'master' ? 'Administrador' : 
                                                           user.tipo === 'vendedor' ? 'Vendedor' : 'Cliente';
        }

        // Carregar menu baseado no tipo de usuário
        function loadMenu() {
            const user = checkAuth();
            const menu = document.getElementById('sidebarMenu');
            let menuContent = '';

            // Menu comum para todos os usuários
            menuContent = `
                <div class="menu-item" onclick="showDashboard()">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </div>
                <div class="menu-item" onclick="showProfile()">
                    <i class="fas fa-user"></i>
                    <span>Perfil</span>
                </div>
            `;

            // Menu específico para master
            if (user.tipo === 'master') {
                menuContent += `
                    <div class="menu-item" onclick="showUsers()">
                        <i class="fas fa-users"></i>
                        <span>Usuários</span>
                    </div>
                    <div class="menu-item" onclick="showProducts()">
                        <i class="fas fa-box"></i>
                        <span>Produtos</span>
                    </div>
                    <div class="menu-item" onclick="showSales()">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Vendas</span>
                    </div>
                    <div class="menu-item" onclick="showReports()">
                        <i class="fas fa-file-alt"></i>
                        <span>Relatórios</span>
                    </div>
                    <div class="menu-item" onclick="showPaymentSettings()">
                        <i class="fas fa-credit-card"></i>
                        <span>Pagamentos</span>
                    </div>
                    <div class="menu-item" onclick="showLoyaltyProgram()">
                        <i class="fas fa-star"></i>
                        <span>Fidelidade</span>
                    </div>
                    <div class="menu-item" onclick="showSettings()">
                        <i class="fas fa-cog"></i>
                        <span>Configurações</span>
                    </div>
                `;
            }

            // Menu específico para vendedor
            if (user.tipo === 'vendedor') {
                menuContent += `
                    <div class="menu-item" onclick="showPDV()">
                        <i class="fas fa-cash-register"></i>
                        <span>PDV</span>
                    </div>
                    <div class="menu-item" onclick="showProducts()">
                        <i class="fas fa-box"></i>
                        <span>Produtos</span>
                    </div>
                    <div class="menu-item" onclick="showSales()">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Vendas</span>
                    </div>
                    <div class="menu-item" onclick="showCommissions()">
                        <i class="fas fa-money-bill-wave"></i>
                        <span>Comissões</span>
                    </div>
                `;
            }

            // Menu específico para cliente
            if (user.tipo === 'cliente') {
                menuContent += `
                    <div class="menu-item" onclick="showStore()">
                        <i class="fas fa-store"></i>
                        <span>Loja Online</span>
                    </div>
                    <div class="menu-item" onclick="showOrders()">
                        <i class="fas fa-shopping-bag"></i>
                        <span>Meus Pedidos</span>
                    </div>
                    <div class="menu-item" onclick="showCart()">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Carrinho</span>
                    </div>
                    <div class="menu-item" onclick="showLoyaltyPoints()">
                        <i class="fas fa-star"></i>
                        <span>Meus Pontos</span>
                    </div>
                `;
            }

            menu.innerHTML = menuContent;
        }

        // Funções de exibição de conteúdo
        function showDashboard() {
            document.getElementById('pageTitle').textContent = 'Dashboard';
            const content = document.getElementById('content');
            const user = checkAuth();

            if (user.tipo === 'vendedor') {
                content.innerHTML = `
                    <div class="dashboard-header">
                        <h3>Visão Geral</h3>
                        <div class="date-filter">
                            <select id="timeFilter" onchange="updateDashboard()">
                                <option value="today">Hoje</option>
                                <option value="week">Esta Semana</option>
                                <option value="month">Este Mês</option>
                                <option value="year">Este Ano</option>
                            </select>
                        </div>
                    </div>
                    <div class="dashboard-grid">
                        <div class="metric-card">
                            <h3>Vendas Hoje</h3>
                            <div class="metric-value" id="salesValue">R$ 0,00</div>
                            <div class="metric-details">
                                <div class="metric-split">
                                    <span>Local: </span>
                                    <span id="localSales">R$ 0,00</span>
                                </div>
                                <div class="metric-split">
                                    <span>Online: </span>
                                    <span id="onlineSales">R$ 0,00</span>
                                </div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <h3>Atendimentos</h3>
                            <div class="metric-value" id="serviceCount">0</div>
                            <div class="metric-details">
                                <div class="metric-split">
                                    <span>Concluídos: </span>
                                    <span id="completedServices">0</span>
                                </div>
                                <div class="metric-split">
                                    <span>Pendentes: </span>
                                    <span id="pendingServices">0</span>
                                </div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <h3>Comissão</h3>
                            <div class="metric-value" id="commissionValue">R$ 0,00</div>
                            <div class="metric-details">
                                <div class="metric-split">
                                    <span>Meta: </span>
                                    <span id="commissionGoal">R$ 0,00</span>
                                </div>
                                <div class="metric-split">
                                    <span>Progresso: </span>
                                    <span id="commissionProgress">0%</span>
                                </div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <h3>Avaliações</h3>
                            <div class="metric-value" id="ratingValue">0.0</div>
                            <div class="metric-details">
                                <div class="rating-stars">★★★★★</div>
                                <div class="rating-count" id="ratingCount">0 avaliações</div>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-row">
                        <div class="dashboard-col">
                            <div class="section-card">
                                <h3>Atendimentos Pendentes</h3>
                                <div class="pending-services" id="pendingServicesList">
                                    <!-- Lista de atendimentos pendentes -->
                                </div>
                            </div>
                        </div>
                        <div class="dashboard-col">
                            <div class="section-card">
                                <h3>Últimas Vendas</h3>
                                <div class="recent-sales" id="recentSalesList">
                                    <!-- Lista de vendas recentes -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-row">
                        <div class="section-card full-width">
                            <h3>Desempenho de Vendas</h3>
                            <div class="chart-container">
                                <canvas id="salesChart"></canvas>
                            </div>
                        </div>
                    </div>
                `;
                
                initializeDashboard();
            }
        }

        function initializeDashboard() {
            // Carrega dados do vendedor
            const user = checkAuth();
            const sales = JSON.parse(localStorage.getItem('vendas')) || [];
            const services = JSON.parse(localStorage.getItem('atendimentos')) || [];
            
            // Filtra vendas do vendedor
            const vendorSales = sales.filter(sale => sale.vendedor === user.email);
            
            // Calcula métricas
            const today = new Date().toISOString().split('T')[0];
            const todaySales = vendorSales.filter(sale => sale.data.startsWith(today));
            
            const totalSales = todaySales.reduce((sum, sale) => sum + sale.total, 0);
            const localSales = todaySales.filter(sale => !sale.online).reduce((sum, sale) => sum + sale.total, 0);
            const onlineSales = todaySales.filter(sale => sale.online).reduce((sum, sale) => sum + sale.total, 0);
            
            // Atualiza métricas no dashboard
            document.getElementById('salesValue').textContent = `R$ ${totalSales.toFixed(2)}`;
            document.getElementById('localSales').textContent = `R$ ${localSales.toFixed(2)}`;
            document.getElementById('onlineSales').textContent = `R$ ${onlineSales.toFixed(2)}`;
            
            const pendingServices = services.filter(service => 
                service.vendedor === user.email && service.status === 'pendente'
            );
            
            document.getElementById('serviceCount').textContent = services.filter(
                service => service.vendedor === user.email
            ).length;
            document.getElementById('completedServices').textContent = services.filter(
                service => service.vendedor === user.email && service.status === 'concluido'
            ).length;
            document.getElementById('pendingServices').textContent = pendingServices.length;
            
            // Calcula comissão
            const commission = totalSales * 0.05; // 5% de comissão
            const commissionGoal = 5000; // Meta mensal
            const progress = (commission / commissionGoal) * 100;
            
            document.getElementById('commissionValue').textContent = `R$ ${commission.toFixed(2)}`;
            document.getElementById('commissionGoal').textContent = `R$ ${commissionGoal.toFixed(2)}`;
            document.getElementById('commissionProgress').textContent = `${progress.toFixed(1)}%`;
            
            // Calcula avaliações
            const ratings = vendorSales.filter(sale => sale.avaliacao).map(sale => sale.avaliacao);
            const averageRating = ratings.length > 0 
                ? ratings.reduce((sum, rating) => sum + rating, 0) / ratings.length 
                : 0;
            
            document.getElementById('ratingValue').textContent = averageRating.toFixed(1);
            document.getElementById('ratingCount').textContent = `${ratings.length} avaliações`;
            
            // Lista atendimentos pendentes
            const pendingList = document.getElementById('pendingServicesList');
            pendingList.innerHTML = pendingServices.length > 0 
                ? pendingServices.map(service => `
                    <div class="service-item">
                        <div class="service-info">
                            <strong>${service.cliente}</strong>
                            <span>${service.tipo}</span>
                        </div>
                        <div class="service-actions">
                            <button class="btn" onclick="viewService(${service.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-success" onclick="completeService(${service.id})">
                                <i class="fas fa-check"></i>
                            </button>
                        </div>
                    </div>
                `).join('')
                : '<p class="empty-state">Nenhum atendimento pendente</p>';
            
            // Lista vendas recentes
            const recentList = document.getElementById('recentSalesList');
            recentList.innerHTML = vendorSales.length > 0
                ? vendorSales.slice(0, 5).map(sale => `
                    <div class="sale-item">
                        <div class="sale-info">
                            <strong>${sale.cliente}</strong>
                            <span>R$ ${sale.total.toFixed(2)}</span>
                        </div>
                        <div class="sale-meta">
                            <span>${new Date(sale.data).toLocaleDateString()}</span>
                            <span class="sale-type ${sale.online ? 'online' : 'local'}">
                                ${sale.online ? 'Online' : 'Local'}
                            </span>
                        </div>
                    </div>
                `).join('')
                : '<p class="empty-state">Nenhuma venda recente</p>';
            
            // Inicializa gráfico de vendas
            const salesCtx = document.getElementById('salesChart');
            if (salesCtx) {
                const salesData = {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                    datasets: [
                        {
                            label: 'Vendas Locais',
                            data: [12, 19, 3, 5, 2, 3],
                            borderColor: '#00e0ff',
                            backgroundColor: '#00e0ff33',
                            tension: 0.1
                        },
                        {
                            label: 'Vendas Online',
                            data: [5, 15, 8, 12, 7, 9],
                            borderColor: '#7c3aed',
                            backgroundColor: '#7c3aed33',
                            tension: 0.1
                        }
                    ]
                };
                
                new Chart(salesCtx, {
                    type: 'line',
                    data: salesData,
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            title: {
                                display: true,
                                text: 'Desempenho de Vendas'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        function showProducts() {
            document.getElementById('pageTitle').textContent = 'Produtos';
            const content = document.getElementById('content');
            const user = checkAuth();

            let productsContent = `
                <div class="product-grid" id="productGrid">
                    <!-- Produtos serão carregados aqui -->
                </div>
            `;

            if (user.tipo === 'master') {
                productsContent += `
                    <button class="btn" onclick="showAddProduct()">
                        <i class="fas fa-plus"></i>
                        Adicionar Produto
                    </button>
                `;
            }

            content.innerHTML = productsContent;
            loadProducts();
        }

        function showPDV() {
            document.getElementById('pageTitle').textContent = 'Ponto de Venda';
            const content = document.getElementById('content');
            
            content.innerHTML = `
                <div class="pdv-container">
                    <div class="pdv-main">
                        <div class="sales-type-toggle">
                            <button class="btn active" onclick="toggleSalesType('local')">
                                <i class="fas fa-store"></i> Venda Local
                            </button>
                            <button class="btn" onclick="toggleSalesType('online')">
                                <i class="fas fa-globe"></i> Venda Online
                            </button>
                        </div>
                        <div class="search-section">
                            <div class="search-wrapper">
                                <input type="text" class="search-input" placeholder="Buscar produto..." oninput="searchPDVProducts()">
                                <div class="search-filters">
                                    <select onchange="filterPDVProducts(this.value)">
                                        <option value="">Todas Categorias</option>
                                        <option value="acessorios">Acessórios</option>
                                        <option value="eletronicos">Eletrônicos</option>
                                        <option value="informatica">Informática</option>
                                    </select>
                                    <select onchange="sortPDVProducts(this.value)">
                                        <option value="relevance">Relevância</option>
                                        <option value="price_asc">Menor Preço</option>
                                        <option value="price_desc">Maior Preço</option>
                                        <option value="name">Nome</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="product-grid" id="pdvProductGrid">
                            <!-- Produtos serão carregados aqui -->
                        </div>
                    </div>
                    <div class="pdv-sidebar">
                        <div class="customer-section">
                            <h3>Cliente</h3>
                            <div class="customer-search">
                                <input type="text" class="search-input" placeholder="Buscar cliente..." oninput="searchCustomers()">
                                <button class="btn" onclick="showNewCustomerForm()">
                                    <i class="fas fa-user-plus"></i>
                                </button>
                            </div>
                            <div id="customerInfo" style="display: none;">
                                <!-- Informações do cliente serão carregadas aqui -->
                            </div>
                            <div class="customer-history" id="customerHistory" style="display: none;">
                                <h4>Histórico do Cliente</h4>
                                <div class="history-items">
                                    <!-- Histórico será carregado aqui -->
                                </div>
                            </div>
                        </div>
                        <div class="cart-section">
                            <h3>Carrinho</h3>
                            <div id="pdvCart">
                                <!-- Itens do carrinho serão carregados aqui -->
                            </div>
                            <div class="cart-summary">
                                <div class="subtotal">
                                    <span>Subtotal:</span>
                                    <span id="cartSubtotal">R$ 0,00</span>
                                </div>
                                <div class="discount">
                                    <span>Desconto:</span>
                                    <div class="discount-input">
                                        <input type="number" id="discountInput" min="0" max="100" step="1" value="0">
                                        <span>%</span>
                                    </div>
                                </div>
                                <div class="shipping" id="shippingSection" style="display: none;">
                                    <span>Frete:</span>
                                    <select id="shippingMethod" onchange="updateShipping()">
                                        <option value="pickup">Retirada na Loja</option>
                                        <option value="express">Entrega Expressa</option>
                                        <option value="standard">Entrega Normal</option>
                                    </select>
                                    <span id="shippingCost">R$ 0,00</span>
                                </div>
                                <div class="total">
                                    <span>Total:</span>
                                    <span id="cartTotal">R$ 0,00</span>
                                </div>
                            </div>
                            <div class="payment-section">
                                <h4>Forma de Pagamento</h4>
                                <div class="payment-options">
                                    <button class="btn" onclick="selectPaymentMethod('dinheiro')">
                                        <i class="fas fa-money-bill-wave"></i>
                                        Dinheiro
                                    </button>
                                    <button class="btn" onclick="selectPaymentMethod('cartao')">
                                        <i class="fas fa-credit-card"></i>
                                        Cartão
                                    </button>
                                    <button class="btn" onclick="selectPaymentMethod('pix')">
                                        <i class="fas fa-qrcode"></i>
                                        PIX
                                    </button>
                                    <button class="btn" onclick="selectPaymentMethod('parcelado')">
                                        <i class="fas fa-clock"></i>
                                        Parcelado
                                    </button>
                                </div>
                                <div id="paymentDetails" style="display: none;">
                                    <!-- Detalhes do pagamento serão mostrados aqui -->
                                </div>
                                <button class="btn btn-success" onclick="finalizePDVSale()">
                                    <i class="fas fa-check"></i>
                                    Finalizar Venda
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            loadPDVProducts();
            initializePDVListeners();
        }

        function toggleSalesType(type) {
            const buttons = document.querySelectorAll('.sales-type-toggle .btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const shippingSection = document.getElementById('shippingSection');
            shippingSection.style.display = type === 'online' ? 'flex' : 'none';
            
            // Recarrega produtos com base no tipo de venda
            loadPDVProducts(type);
        }

        function showNewCustomerForm() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>Novo Cliente</h3>
                    <form id="newCustomerForm">
                        <div class="form-group">
                            <label>Nome</label>
                            <input type="text" name="nome" required>
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label>Telefone</label>
                            <input type="tel" name="telefone" required>
                        </div>
                        <div class="form-group">
                            <label>CPF</label>
                            <input type="text" name="cpf" required>
                        </div>
                        <div class="form-group">
                            <label>Endereço</label>
                            <input type="text" name="endereco" required>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="closeModal()">Cancelar</button>
                            <button type="submit" class="btn btn-success">Salvar</button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
            
            document.getElementById('newCustomerForm').onsubmit = function(e) {
                e.preventDefault();
                saveNewCustomer(this);
            };
        }

        function saveNewCustomer(form) {
            const formData = new FormData(form);
            const customer = {
                id: Date.now(),
                nome: formData.get('nome'),
                email: formData.get('email'),
                telefone: formData.get('telefone'),
                cpf: formData.get('cpf'),
                endereco: formData.get('endereco'),
                dataCadastro: new Date().toISOString(),
                pontos: 0,
                compras: []
            };
            
            const customers = JSON.parse(localStorage.getItem('clientes') || '[]');
            customers.push(customer);
            localStorage.setItem('clientes', JSON.stringify(customers));
            
            closeModal();
            selectCustomer(customer);
        }

        function initializePDVListeners() {
            // Inicializa listeners para inputs de desconto e frete
            document.getElementById('discountInput').addEventListener('input', updateCartTotal);
            document.getElementById('shippingMethod')?.addEventListener('change', updateCartTotal);
            
            // Inicializa máscaras para inputs numéricos
            const cpfInputs = document.querySelectorAll('input[name="cpf"]');
            cpfInputs.forEach(input => {
                input.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    if (value.length <= 11) {
                        value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
                        e.target.value = value;
                    }
                });
            });
            
            const phoneInputs = document.querySelectorAll('input[name="telefone"]');
            phoneInputs.forEach(input => {
                input.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    if (value.length <= 11) {
                        value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
                        e.target.value = value;
                    }
                });
            });
        }

        function updateCartTotal() {
            const cartItems = JSON.parse(localStorage.getItem('pdvCart')) || [];
            const subtotal = cartItems.reduce((sum, item) => sum + (item.preco * item.quantidade), 0);
            
            const discountPercent = parseFloat(document.getElementById('discountInput').value) || 0;
            const discountAmount = subtotal * (discountPercent / 100);
            
            let shippingCost = 0;
            const shippingMethod = document.getElementById('shippingMethod')?.value;
            if (shippingMethod) {
                switch(shippingMethod) {
                    case 'express':
                        shippingCost = 30;
                        break;
                    case 'standard':
                        shippingCost = 15;
                        break;
                }
            }
            
            const total = subtotal - discountAmount + shippingCost;
            
            document.getElementById('cartSubtotal').textContent = `R$ ${subtotal.toFixed(2)}`;
            document.getElementById('cartTotal').textContent = `R$ ${total.toFixed(2)}`;
            if (shippingMethod) {
                document.getElementById('shippingCost').textContent = `R$ ${shippingCost.toFixed(2)}`;
            }
        }

        function showPaymentSettings() {
            document.getElementById('pageTitle').textContent = 'Configurações de Pagamento';
            const content = document.getElementById('content');
            const user = checkAuth();

            if (user.tipo !== 'master') {
                showNotification('Acesso restrito apenas para administradores', 'error');
                return;
            }

            content.innerHTML = `
                <div class="payment-settings">
                    <h3>Configurações de Parcelamento</h3>
                    <div class="installment-options">
                        <div class="installment-option">
                            <h4>Débito</h4>
                            <div class="form-group">
                                <label>Taxa (%)</label>
                                <input type="number" value="1.5" step="0.1">
                    </div>
                    </div>
                        <div class="installment-option">
                            <h4>Crédito à Vista</h4>
                            <div class="form-group">
                                <label>Taxa (%)</label>
                                <input type="number" value="2.5" step="0.1">
                    </div>
                    </div>
                        <div class="installment-option">
                            <h4>Parcelado</h4>
                            <div class="form-group">
                                <label>Taxa Base (%)</label>
                                <input type="number" value="3.5" step="0.1">
                </div>
                            <div class="form-group">
                                <label>Juros por Parcela (%)</label>
                                <input type="number" value="1.2" step="0.1">
                    </div>
                </div>
                    </div>
                    <button class="btn" onclick="savePaymentSettings()">
                        <i class="fas fa-save"></i>
                        Salvar Configurações
                    </button>
                </div>
            `;
        }

        function showLoyaltyProgram() {
            document.getElementById('pageTitle').textContent = 'Programa de Fidelidade';
            const content = document.getElementById('content');
            const user = checkAuth();

            if (user.tipo !== 'master') {
                showNotification('Acesso restrito apenas para administradores', 'error');
                return;
            }

            content.innerHTML = `
                <div class="loyalty-program">
                    <h3>Configurações do Programa de Fidelidade</h3>
                    <div class="points-system">
                        <div class="points-card">
                            <h4>Pontos por Real</h4>
                            <div class="form-group">
                                <label>Valor em Pontos</label>
                                <input type="number" value="1" min="0.1" step="0.1">
                    </div>
                    </div>
                        <div class="points-card">
                            <h4>Validade dos Pontos</h4>
                            <div class="form-group">
                                <label>Meses</label>
                                <input type="number" value="12" min="1">
                    </div>
                    </div>
                        <div class="points-card">
                            <h4>Valor do Ponto</h4>
                            <div class="form-group">
                                <label>Valor em Reais</label>
                                <input type="number" value="0.01" min="0.01" step="0.01">
                </div>
                    </div>
                </div>
                    <button class="btn" onclick="saveLoyaltySettings()">
                        <i class="fas fa-save"></i>
                        Salvar Configurações
                    </button>
                </div>
            `;
        }

        function savePaymentSettings() {
            const user = checkAuth();
            if (user.tipo !== 'master') {
                showNotification('Acesso restrito apenas para administradores', 'error');
                return;
            }

            const paymentSettings = {
                debit: {
                    rate: parseFloat(document.querySelector('.installment-option:nth-child(1) input').value)
                },
                credit: {
                    rate: parseFloat(document.querySelector('.installment-option:nth-child(2) input').value)
                },
                installment: {
                    baseRate: parseFloat(document.querySelector('.installment-option:nth-child(3) input').value),
                    interestPerInstallment: parseFloat(document.querySelector('.installment-option:nth-child(3) input:nth-child(2)').value)
                }
            };

            // Salvar no localStorage
            localStorage.setItem('paymentSettings', JSON.stringify(paymentSettings));
            showNotification('Configurações de pagamento salvas com sucesso!', 'success');
        }

        function saveLoyaltySettings() {
            const user = checkAuth();
            if (user.tipo !== 'master') {
                showNotification('Acesso restrito apenas para administradores', 'error');
                return;
            }

            const loyaltySettings = {
                pointsPerReal: parseFloat(document.querySelector('.points-card:nth-child(1) input').value),
                pointsValidity: parseInt(document.querySelector('.points-card:nth-child(2) input').value),
                pointValue: parseFloat(document.querySelector('.points-card:nth-child(3) input').value)
            };

            // Salvar no localStorage
            localStorage.setItem('loyaltySettings', JSON.stringify(loyaltySettings));
            showNotification('Configurações de fidelidade salvas com sucesso!', 'success');
        }

        function showCommissions() {
            document.getElementById('pageTitle').textContent = 'Comissões';
            const content = document.getElementById('content');
            const user = checkAuth();

            if (user.tipo !== 'vendedor') {
                showNotification('Acesso restrito apenas para vendedores', 'error');
                return;
            }

            content.innerHTML = `
                <div class="card">
                    <h3>Minhas Comissões</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Venda</th>
                                    <th>Valor</th>
                                    <th>Comissão</th>
                                    <th>Status</th>
                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>01/01/2024</td>
                                    <td>#1234</td>
                                    <td>R$ 1.000,00</td>
                                    <td>R$ 100,00</td>
                                    <td><span class="status pending">Pendente</span></td>
                                </tr>
                                <tr>
                                    <td>02/01/2024</td>
                                    <td>#1235</td>
                                    <td>R$ 2.000,00</td>
                                    <td>R$ 200,00</td>
                                    <td><span class="status paid">Pago</span></td>
                                </tr>
                            </tbody>
                        </table>
                </div>
                    <div class="summary">
                        <div class="summary-item">
                            <span>Total de Vendas</span>
                            <strong>R$ 3.000,00</strong>
                                </div>
                        <div class="summary-item">
                            <span>Total de Comissões</span>
                            <strong>R$ 300,00</strong>
                            </div>
                        <div class="summary-item">
                            <span>Comissões Pendentes</span>
                            <strong>R$ 100,00</strong>
                        </div>
                    </div>
                </div>
            `;
        }

        function showLoyaltyPoints() {
            document.getElementById('pageTitle').textContent = 'Meus Pontos';
            const content = document.getElementById('content');
            const user = checkAuth();

            if (user.tipo !== 'cliente') {
                showNotification('Acesso restrito apenas para clientes', 'error');
                return;
            }

            content.innerHTML = `
                <div class="card">
                    <h3>Programa de Fidelidade</h3>
                    <div class="points-summary">
                        <div class="points-card">
                            <h4>Pontos Disponíveis</h4>
                            <div class="points-value">1.000</div>
                            <div class="points-details">
                                <span>Valor em Reais: R$ 10,00</span>
                                <span>Validade: 31/12/2024</span>
                    </div>
                    </div>
                        <div class="points-card">
                            <h4>Histórico de Pontos</h4>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                            <th>Data</th>
                                            <th>Descrição</th>
                                            <th>Pontos</th>
                                            <th>Saldo</th>
                                </tr>
                            </thead>
                                    <tbody>
                                        <tr>
                                            <td>01/01/2024</td>
                                            <td>Compra #1234</td>
                                            <td>+100</td>
                                            <td>1.000</td>
                                        </tr>
                                        <tr>
                                            <td>15/12/2023</td>
                                            <td>Resgate de Pontos</td>
                                            <td>-50</td>
                                            <td>900</td>
                                        </tr>
                                    </tbody>
                        </table>
                    </div>
                </div>
                </div>
                    <button class="btn" onclick="redeemPoints()">
                        <i class="fas fa-gift"></i>
                        Resgatar Pontos
                </button>
                </div>
            `;
        }

        // Funções de utilidade
        function logout() {
            sessionStorage.removeItem('usuarioLogado');
            window.location.href = 'index.html';
        }

        function showNotification(message, type = 'info') {
            const notifications = document.getElementById('notifications');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            notifications.appendChild(notification);
            setTimeout(() => notification.remove(), 5000);
        }

        // Funções do PDV
        function searchPDVProducts() {
            const searchTerm = document.querySelector('.search-input').value.toLowerCase();
            const products = JSON.parse(localStorage.getItem('produtos')) || [];
            const filteredProducts = products.filter(product => 
                product.nome.toLowerCase().includes(searchTerm) ||
                product.codigo.toLowerCase().includes(searchTerm)
            );
            displayPDVProducts(filteredProducts);
        }

        function displayPDVProducts(products) {
            const productGrid = document.getElementById('pdvProductGrid');
            productGrid.innerHTML = products.map(product => `
                <div class="product-card" onclick="addToPDVCart('${product.codigo}')">
                    <div class="product-image">
                        <img src="${product.imagem || 'default-product.png'}" alt="${product.nome}">
                    </div>
                    <div class="product-info">
                        <h4>${product.nome}</h4>
                        <p class="product-price">R$ ${product.preco.toFixed(2)}</p>
                        <p class="product-stock">Estoque: ${product.estoque}</p>
                    </div>
                </div>
            `).join('');
        }

        function loadPDVProducts(type) {
            const products = JSON.parse(localStorage.getItem('produtos')) || [];
            const filteredProducts = products.filter(product => 
                product.categoria.toLowerCase().includes(type === 'online' ? 'online' : '')
            );
            displayPDVProducts(filteredProducts);
        }

        function searchCustomers() {
            const searchTerm = document.querySelector('.customer-search .search-input').value.toLowerCase();
            const customers = JSON.parse(localStorage.getItem('clientes')) || [];
            const filteredCustomers = customers.filter(customer => 
                customer.nome.toLowerCase().includes(searchTerm) ||
                customer.email.toLowerCase().includes(searchTerm)
            );
            displayCustomerResults(filteredCustomers);
        }

        function displayCustomerResults(customers) {
            const customerInfo = document.getElementById('customerInfo');
            if (customers.length > 0) {
                customerInfo.style.display = 'block';
                customerInfo.innerHTML = customers.map(customer => `
                    <div class="customer-card" onclick="selectCustomer('${customer.email}')">
                        <h4>${customer.nome}</h4>
                        <p>${customer.email}</p>
                        <p>Pontos: ${customer.pontos || 0}</p>
                    </div>
                `).join('');
            } else {
                customerInfo.style.display = 'none';
            }
        }

        function selectCustomer(email) {
            const customer = JSON.parse(localStorage.getItem('clientes')).find(c => c.email === email);
            if (customer) {
                document.getElementById('customerInfo').innerHTML = `
                    <div class="selected-customer">
                        <h4>${customer.nome}</h4>
                        <p>${customer.email}</p>
                        <p>Pontos: ${customer.pontos || 0}</p>
                        <button class="btn btn-sm" onclick="clearCustomer()">Limpar</button>
                    </div>
                `;
                updatePDVTotal();
            }
        }

        function clearCustomer() {
            document.getElementById('customerInfo').innerHTML = '';
            document.querySelector('.customer-search .search-input').value = '';
            updatePDVTotal();
        }

        function addToPDVCart(productCode) {
            const products = JSON.parse(localStorage.getItem('produtos')) || [];
            const product = products.find(p => p.codigo === productCode);
            if (!product) return;

            const cartItems = JSON.parse(localStorage.getItem('pdvCart')) || [];
            const existingItem = cartItems.find(item => item.codigo === productCode);

            if (existingItem) {
                existingItem.quantidade++;
            } else {
                cartItems.push({
                    codigo: product.codigo,
                    nome: product.nome,
                    preco: product.preco,
                    quantidade: 1
                });
            }

            localStorage.setItem('pdvCart', JSON.stringify(cartItems));
            updatePDVCart();
        }

        function updatePDVCart() {
            const cartItems = JSON.parse(localStorage.getItem('pdvCart')) || [];
            const cartContainer = document.getElementById('pdvCart');
            
            cartContainer.innerHTML = cartItems.map(item => `
                <div class="cart-item">
                    <div class="item-info">
                        <h4>${item.nome}</h4>
                        <p>R$ ${item.preco.toFixed(2)} x ${item.quantidade}</p>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-sm" onclick="updatePDVItemQuantity('${item.codigo}', ${item.quantidade - 1})">-</button>
                        <button class="btn btn-sm" onclick="updatePDVItemQuantity('${item.codigo}', ${item.quantidade + 1})">+</button>
                        <button class="btn btn-sm btn-danger" onclick="removeFromPDVCart('${item.codigo}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');

            updatePDVTotal();
        }

        function updatePDVItemQuantity(productCode, newQuantity) {
            if (newQuantity < 1) return;
            
            const cartItems = JSON.parse(localStorage.getItem('pdvCart')) || [];
            const item = cartItems.find(item => item.codigo === productCode);
            
            if (item) {
                item.quantidade = newQuantity;
                localStorage.setItem('pdvCart', JSON.stringify(cartItems));
                updatePDVCart();
            }
        }

        function removeFromPDVCart(productCode) {
            const cartItems = JSON.parse(localStorage.getItem('pdvCart')) || [];
            const newCartItems = cartItems.filter(item => item.codigo !== productCode);
            localStorage.setItem('pdvCart', JSON.stringify(newCartItems));
            updatePDVCart();
        }

        function updatePDVTotal() {
            const cartItems = JSON.parse(localStorage.getItem('pdvCart')) || [];
            const discount = parseFloat(document.getElementById('discountInput').value) || 0;
            
            const subtotal = cartItems.reduce((total, item) => total + (item.preco * item.quantidade), 0);
            const discountValue = (subtotal * discount) / 100;
            const total = subtotal - discountValue;

            document.getElementById('cartSubtotal').textContent = `R$ ${subtotal.toFixed(2)}`;
            document.getElementById('cartTotal').textContent = `R$ ${total.toFixed(2)}`;
        }

        function selectPaymentMethod(method) {
            // Implementar lógica de seleção de método de pagamento
            alert(`Método de pagamento selecionado: ${method}`);
        }

        function finalizePDVSale() {
            const cartItems = JSON.parse(localStorage.getItem('pdvCart')) || [];
            if (cartItems.length === 0) {
                alert('Adicione produtos ao carrinho antes de finalizar a venda.');
                return;
            }

            const customerInfo = document.getElementById('customerInfo').innerHTML;
            if (!customerInfo) {
                alert('Selecione um cliente antes de finalizar a venda.');
                return;
            }

            // Implementar lógica de finalização de venda
            alert('Venda finalizada com sucesso!');
            localStorage.removeItem('pdvCart');
            updatePDVCart();
        }

        // Funções da Loja Online
        function searchStoreProducts() {
            const searchTerm = document.querySelector('.store-container .search-input').value.toLowerCase();
            const products = JSON.parse(localStorage.getItem('produtos')) || [];
            const filteredProducts = products.filter(product => 
                product.nome.toLowerCase().includes(searchTerm) ||
                product.codigo.toLowerCase().includes(searchTerm)
            );
            displayStoreProducts(filteredProducts);
        }

        function displayStoreProducts(products) {
            const productGrid = document.getElementById('storeProductGrid');
            productGrid.innerHTML = products.map(product => `
                <div class="product-card">
                    <div class="product-badges">
                        ${product.isNew ? '<span class="badge new">Novo</span>' : ''}
                        ${product.discount ? '<span class="badge sale">-${product.discount}%</span>' : ''}
                    </div>
                    <div class="product-image">
                        <img src="${product.imagem || 'default-product.png'}" alt="${product.nome}">
                        <div class="product-actions">
                            <button class="action-btn" onclick="addToWishlist('${product.codigo}')">
                                <i class="fas fa-heart"></i>
                            </button>
                            <button class="action-btn" onclick="quickView('${product.codigo}')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    <div class="product-info">
                        <div class="product-category">${product.categoria || 'Acessórios'}</div>
                        <h4 class="product-title">${product.nome}</h4>
                        <div class="product-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="far fa-star"></i>
                            <span>(${product.reviews || 0})</span>
                        </div>
                        <div class="product-price">
                            ${product.discount ? 
                                `<span class="original-price">R$ ${product.preco.toFixed(2)}</span>
                                 <span class="final-price">R$ ${(product.preco * (1 - product.discount/100)).toFixed(2)}</span>` :
                                `<span class="final-price">R$ ${product.preco.toFixed(2)}</span>`
                            }
                        </div>
                        <div class="product-installments">
                            ou 12x de R$ ${(product.preco/12).toFixed(2)}
                        </div>
                        <button class="btn add-to-cart" onclick="addToCart('${product.codigo}')">
                            <i class="fas fa-cart-plus"></i>
                            Adicionar ao Carrinho
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function loadStoreProducts() {
            const products = JSON.parse(localStorage.getItem('produtos')) || [];
            displayStoreProducts(products);
        }

        function addToCart(productCode) {
            const products = JSON.parse(localStorage.getItem('produtos')) || [];
            const product = products.find(p => p.codigo === productCode);
            if (!product) return;

            const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            const existingItem = cartItems.find(item => item.codigo === productCode);

            if (existingItem) {
                existingItem.quantidade++;
            } else {
                cartItems.push({
                    codigo: product.codigo,
                    nome: product.nome,
                    preco: product.preco,
                    quantidade: 1
                });
            }

            localStorage.setItem('cart', JSON.stringify(cartItems));
            updateCart();
        }

        function updateCart() {
            const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            const cartContainer = document.getElementById('cartItems');
            
            cartContainer.innerHTML = cartItems.map(item => `
                <div class="cart-item">
                    <div class="item-info">
                        <h4>${item.nome}</h4>
                        <p>R$ ${item.preco.toFixed(2)} x ${item.quantidade}</p>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-sm" onclick="updateItemQuantity('${item.codigo}', ${item.quantidade - 1})">-</button>
                        <button class="btn btn-sm" onclick="updateItemQuantity('${item.codigo}', ${item.quantidade + 1})">+</button>
                        <button class="btn btn-sm btn-danger" onclick="removeFromCart('${item.codigo}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');

            updateCartTotal();
        }

        function updateItemQuantity(productCode, newQuantity) {
            if (newQuantity < 1) return;
            
            const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            const item = cartItems.find(item => item.codigo === productCode);
            
            if (item) {
                item.quantidade = newQuantity;
                localStorage.setItem('cart', JSON.stringify(cartItems));
                updateCart();
            }
        }

        function removeFromCart(productCode) {
            const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            const newCartItems = cartItems.filter(item => item.codigo !== productCode);
            localStorage.setItem('cart', JSON.stringify(newCartItems));
            updateCart();
        }

        function updateCartTotal() {
            const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            const subtotal = cartItems.reduce((total, item) => total + (item.preco * item.quantidade), 0);
            const discount = 0; // Implementar sistema de desconto
            const total = subtotal - discount;

            document.getElementById('cartSubtotal').textContent = `R$ ${subtotal.toFixed(2)}`;
            document.getElementById('cartDiscount').textContent = `R$ ${discount.toFixed(2)}`;
            document.getElementById('cartTotal').textContent = `R$ ${total.toFixed(2)}`;
        }

        function checkout() {
            const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            if (cartItems.length === 0) {
                alert('Adicione produtos ao carrinho antes de finalizar a compra.');
                return;
            }

            // Implementar lógica de checkout
            alert('Compra finalizada com sucesso!');
            localStorage.removeItem('cart');
            updateCart();
        }

        function showStore() {
            document.getElementById('mainContent').innerHTML = `
                <div class="store-container">
                    <div class="store-header">
                        <div class="search-section">
                            <div class="search-bar">
                                <input type="text" placeholder="Buscar produtos...">
                                <i class="fas fa-search"></i>
                            </div>
                            <div class="category-filter">
                                <select>
                                    <option value="">Todas as categorias</option>
                                    <option value="acessorios">Acessórios</option>
                                    <option value="eletronicos">Eletrônicos</option>
                                    <option value="vestuario">Vestuário</option>
                                </select>
                            </div>
                        </div>
                        <div class="cart-preview" onclick="showCart()">
                            <i class="fas fa-shopping-cart"></i>
                            <span id="cartCount" class="cart-count">0</span>
                        </div>
                    </div>

                    <div class="featured-products">
                        <h2>Produtos em Destaque</h2>
                        <div id="featuredSlider" class="featured-slider">
                            <!-- Produtos em destaque serão inseridos aqui -->
                        </div>
                    </div>

                    <div class="section-nav">
                        <button class="section-btn active" onclick="filterProducts('all')">Todos</button>
                        <button class="section-btn" onclick="filterProducts('new')">Novidades</button>
                        <button class="section-btn" onclick="filterProducts('sale')">Promoções</button>
                        <button class="section-btn" onclick="filterProducts('bestsellers')">Mais Vendidos</button>
                    </div>

                    <div id="productGrid" class="product-grid">
                        <!-- Produtos serão inseridos aqui -->
                    </div>

                    <div class="store-footer">
                        <div class="benefits">
                            <div class="benefit-item">
                                <i class="fas fa-truck"></i>
                                <span>Frete Grátis</span>
                            </div>
                            <div class="benefit-item">
                                <i class="fas fa-lock"></i>
                                <span>Compra Segura</span>
                            </div>
                            <div class="benefit-item">
                                <i class="fas fa-credit-card"></i>
                                <span>Parcelamento</span>
                            </div>
                            <div class="benefit-item">
                                <i class="fas fa-undo"></i>
                                <span>Devolução Fácil</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal do Carrinho -->
                <div id="cartModal" class="cart-modal">
                    <div class="cart-content">
                        <div class="cart-header">
                            <h2>Seu Carrinho</h2>
                            <button class="close-btn" onclick="closeCart()">×</button>
                        </div>
                        <div id="cartItems" class="cart-items">
                            <!-- Itens do carrinho serão inseridos aqui -->
                        </div>
                        <div class="cart-summary">
                            <div class="summary-item">
                                <span>Subtotal</span>
                                <span id="cartSubtotal">R$ 0,00</span>
                            </div>
                            <div class="summary-item">
                                <span>Frete</span>
                                <span>Grátis</span>
                            </div>
                            <div class="summary-item total">
                                <span>Total</span>
                                <span id="cartTotal">R$ 0,00</span>
                            </div>
                        </div>
                        <div class="cart-actions">
                            <button class="btn" onclick="closeCart()">Continuar Comprando</button>
                            <button class="btn btn-primary" onclick="proceedToCheckout()">Finalizar Compra</button>
                        </div>
                    </div>
                </div>

                <!-- Modal de Checkout -->
                <div id="checkoutModal" class="checkout-modal">
                    <div class="checkout-content">
                        <div class="checkout-header">
                            <h2>Finalizar Compra</h2>
                            <button class="close-btn" onclick="closeCheckout()">×</button>
                        </div>
                        <div class="checkout-steps">
                            <!-- Passo 1: Endereço de Entrega -->
                            <div id="step1" class="step active">
                                <h3>Endereço de Entrega</h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="zipCode">CEP</label>
                                        <input type="text" id="zipCode" onblur="fetchAddressByZipCode(this.value)" placeholder="00000-000">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="street">Rua</label>
                                        <input type="text" id="street" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="number">Número</label>
                                        <input type="text" id="number" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="complement">Complemento</label>
                                        <input type="text" id="complement">
                                    </div>
                                    <div class="form-group">
                                        <label for="neighborhood">Bairro</label>
                                        <input type="text" id="neighborhood" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="city">Cidade</label>
                                        <input type="text" id="city" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="state">Estado</label>
                                        <input type="text" id="state" required>
                                    </div>
                                </div>
                                <div class="order-actions">
                                    <button class="btn" onclick="closeCheckout()">Cancelar</button>
                                    <button class="btn btn-primary" onclick="nextStep()">Próximo</button>
                                </div>
                            </div>

                            <!-- Passo 2: Método de Pagamento -->
                            <div id="step2" class="step">
                                <h3>Método de Pagamento</h3>
                                <div class="payment-options">
                                    <div class="payment-option" data-method="credit" onclick="selectPaymentMethod('credit')">
                                        <i class="fas fa-credit-card"></i>
                                        <p>Cartão de Crédito</p>
                                    </div>
                                    <div class="payment-option" data-method="pix" onclick="selectPaymentMethod('pix')">
                                        <i class="fas fa-qrcode"></i>
                                        <p>PIX</p>
                                    </div>
                                    <div class="payment-option" data-method="boleto" onclick="selectPaymentMethod('boleto')">
                                        <i class="fas fa-barcode"></i>
                                        <p>Boleto</p>
                                    </div>
                                </div>
                                <div class="order-actions">
                                    <button class="btn" onclick="prevStep()">Voltar</button>
                                    <button class="btn btn-primary" onclick="nextStep()">Próximo</button>
                                </div>
                            </div>

                            <!-- Passo 3: Confirmação -->
                            <div id="step3" class="step">
                                <h3>Confirmação do Pedido</h3>
                                <div class="order-summary">
                                    <h4>Resumo do Pedido</h4>
                                    <div id="orderItems">
                                        <!-- Itens do pedido serão inseridos aqui -->
                                    </div>
                                    <div class="summary-item">
                                        <span>Subtotal</span>
                                        <span id="orderSubtotal">R$ 0,00</span>
                                    </div>
                                    <div class="summary-item">
                                        <span>Frete</span>
                                        <span>Grátis</span>
                                    </div>
                                    <div class="summary-item total">
                                        <span>Total</span>
                                        <span id="orderTotal">R$ 0,00</span>
                                    </div>
                                </div>
                                <div class="order-actions">
                                    <button class="btn" onclick="prevStep()">Voltar</button>
                                    <button class="btn btn-primary" onclick="confirmOrder()">Confirmar Pedido</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            loadFeaturedProducts();
            loadProducts();
        }

        function showCart() {
            const modal = document.getElementById('cartModal');
            modal.style.display = 'block';
            updateCart();
        }

        function closeCart() {
            const modal = document.getElementById('cartModal');
            modal.style.display = 'none';
        }

        function proceedToCheckout() {
            const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            if (cartItems.length === 0) {
                showNotification('Adicione produtos ao carrinho antes de finalizar a compra', 'error');
                return;
            }

            closeCart();
            const checkoutModal = document.getElementById('checkoutModal');
            checkoutModal.style.display = 'block';
            showStep(1);
        }

        function closeCheckout() {
            const checkoutModal = document.getElementById('checkoutModal');
            checkoutModal.style.display = 'none';
        }

        function showStep(stepNumber) {
            const steps = document.querySelectorAll('.step');
            steps.forEach(step => step.classList.remove('active'));
            document.getElementById(`step${stepNumber}`).classList.add('active');
        }

        function previousStep() {
            const currentStep = document.querySelector('.step.active');
            const currentStepNumber = parseInt(currentStep.id.replace('step', ''));
            if (currentStepNumber > 1) {
                showStep(currentStepNumber - 1);
            }
        }

        function nextStep() {
            const currentStep = document.querySelector('.step.active');
            const currentStepNumber = parseInt(currentStep.id.replace('step', ''));
            if (currentStepNumber < 3) {
                showStep(currentStepNumber + 1);
            }
        }

        function selectPayment(method) {
            const paymentDetails = document.getElementById('paymentDetails');
            let detailsHTML = '';

            switch(method) {
                case 'pix':
                    detailsHTML = `
                        <div class="pix-details">
                            <p>Pague com PIX e receba 5% de desconto!</p>
                            <div class="pix-qrcode">
                                <!-- QR Code será gerado aqui -->
                            </div>
                        </div>
                    `;
                    break;
                case 'credit':
                    detailsHTML = `
                        <div class="credit-details">
                            <div class="form-group">
                                <label>Número do Cartão</label>
                                <input type="text" id="cardNumber" maxlength="16">
                            </div>
                            <div class="form-group">
                                <label>Nome no Cartão</label>
                                <input type="text" id="cardName">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Validade</label>
                                    <input type="text" id="cardExpiry" maxlength="5">
                                </div>
                                <div class="form-group">
                                    <label>CVV</label>
                                    <input type="text" id="cardCvv" maxlength="3">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Parcelas</label>
                                <select id="installments">
                                    <option value="1">1x sem juros</option>
                                    <option value="2">2x sem juros</option>
                                    <option value="3">3x sem juros</option>
                                    <option value="4">4x sem juros</option>
                                    <option value="5">5x sem juros</option>
                                    <option value="6">6x sem juros</option>
                                    <option value="7">7x sem juros</option>
                                    <option value="8">8x sem juros</option>
                                    <option value="9">9x sem juros</option>
                                    <option value="10">10x sem juros</option>
                                    <option value="11">11x sem juros</option>
                                    <option value="12">12x sem juros</option>
                                </select>
                            </div>
                        </div>
                    `;
                    break;
                case 'debit':
                    detailsHTML = `
                        <div class="debit-details">
                            <div class="form-group">
                                <label>Número do Cartão</label>
                                <input type="text" id="debitCardNumber" maxlength="16">
                            </div>
                            <div class="form-group">
                                <label>Nome no Cartão</label>
                                <input type="text" id="debitCardName">
                            </div>
                            <div class="form-group">
                                <label>Validade</label>
                                <input type="text" id="debitCardExpiry" maxlength="5">
                            </div>
                            <div class="form-group">
                                <label>CVV</label>
                                <input type="text" id="debitCardCvv" maxlength="3">
                            </div>
                        </div>
                    `;
                    break;
                case 'boleto':
                    detailsHTML = `
                        <div class="boleto-details">
                            <p>O boleto será gerado após a confirmação do pedido.</p>
                            <p>O prazo de pagamento é de 2 dias úteis.</p>
                        </div>
                    `;
                    break;
            }

            paymentDetails.innerHTML = detailsHTML;
            nextStep();
        }

        function confirmOrder() {
            const user = checkAuth();
            const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            const total = cartItems.reduce((sum, item) => sum + (item.preco * item.quantidade), 0);

            const order = {
                id: Date.now(),
                cliente: user.email,
                data: new Date().toISOString(),
                itens: cartItems,
                total: total,
                status: 'pendente',
                endereco: {
                    cep: document.getElementById('cep').value,
                    endereco: document.getElementById('endereco').value,
                    numero: document.getElementById('numero').value,
                    complemento: document.getElementById('complemento').value,
                    bairro: document.getElementById('bairro').value,
                    cidade: document.getElementById('cidade').value,
                    estado: document.getElementById('estado').value
                }
            };

            const orders = JSON.parse(localStorage.getItem('pedidos') || '[]');
            orders.push(order);
            localStorage.setItem('pedidos', JSON.stringify(orders));
            localStorage.removeItem('cart');

            closeCheckout();
            showNotification('Pedido realizado com sucesso!', 'success');
            updateCartCount();
        }

        function buscarEndereco() {
            const cep = document.getElementById('cep').value.replace(/\D/g, '');
            if (cep.length !== 8) return;

            fetch(`https://viacep.com.br/ws/${cep}/json/`)
                .then(response => response.json())
                .then(data => {
                    if (!data.erro) {
                        document.getElementById('endereco').value = data.logradouro;
                        document.getElementById('bairro').value = data.bairro;
                        document.getElementById('cidade').value = data.localidade;
                        document.getElementById('estado').value = data.uf;
                    }
                })
                .catch(error => {
                    showNotification('Erro ao buscar endereço', 'error');
                });
        }

        function loadFeaturedProducts() {
            const products = JSON.parse(localStorage.getItem('produtos')) || [];
            const featuredProducts = products.filter(p => p.destaque).slice(0, 5);
            
            const slider = document.getElementById('featuredSlider');
            slider.innerHTML = featuredProducts.map(product => `
                <div class="featured-product">
                    <div class="product-image">
                        <img src="${product.imagem || 'default-product.png'}" alt="${product.nome}">
                    </div>
                    <div class="product-info">
                        <h3>${product.nome}</h3>
                        <p class="price">R$ ${product.preco.toFixed(2)}</p>
                        <button class="btn" onclick="addToCart('${product.codigo}')">Comprar</button>
                    </div>
                </div>
            `).join('');
        }

        function updateCartCount() {
            const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
            const count = cartItems.reduce((sum, item) => sum + item.quantidade, 0);
            document.getElementById('cartCount').textContent = count;
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', () => {
            loadUserInfo();
            loadMenu();
            showDashboard();
        });

        // Funções do Carrinho
        let cart = [];
        let currentStep = 1;

        function showCart() {
            document.getElementById('cartModal').style.display = 'block';
            updateCartDisplay();
        }

        function closeCart() {
            document.getElementById('cartModal').style.display = 'none';
        }

        function updateCartDisplay() {
            const cartItems = document.getElementById('cartItems');
            const cartCount = document.getElementById('cartCount');
            const cartTotal = document.getElementById('cartTotal');
            
            cartItems.innerHTML = '';
            let total = 0;
            
            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                const itemElement = document.createElement('div');
                itemElement.className = 'cart-item';
                itemElement.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" style="width: 60px; height: 60px; object-fit: cover;">
                    <div class="item-info">
                        <h4>${item.name}</h4>
                        <p>R$ ${item.price.toFixed(2)} x ${item.quantity}</p>
                        <p>Total: R$ ${itemTotal.toFixed(2)}</p>
                    </div>
                    <div class="item-actions">
                        <button onclick="updateQuantity(${index}, ${item.quantity - 1})">-</button>
                        <button onclick="updateQuantity(${index}, ${item.quantity + 1})">+</button>
                        <button onclick="removeFromCart(${index})">×</button>
                    </div>
                `;
                cartItems.appendChild(itemElement);
            });
            
            cartCount.textContent = cart.length;
            cartTotal.textContent = `R$ ${total.toFixed(2)}`;
        }

        function addToCart(product) {
            const existingItem = cart.find(item => item.id === product.id);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    image: product.image,
                    quantity: 1
                });
            }
            
            updateCartDisplay();
            showCart();
        }

        function updateQuantity(index, newQuantity) {
            if (newQuantity <= 0) {
                removeFromCart(index);
                return;
            }
            
            cart[index].quantity = newQuantity;
            updateCartDisplay();
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartDisplay();
        }

        // Funções do Checkout
        function proceedToCheckout() {
            closeCart();
            document.getElementById('checkoutModal').style.display = 'block';
            showStep(1);
        }

        function closeCheckout() {
            document.getElementById('checkoutModal').style.display = 'none';
        }

        function showStep(stepNumber) {
            currentStep = stepNumber;
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
            document.getElementById(`step${stepNumber}`).classList.add('active');
        }

        function nextStep() {
            if (currentStep < 3) {
                showStep(currentStep + 1);
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                showStep(currentStep - 1);
            }
        }

        function selectPaymentMethod(method) {
            document.querySelectorAll('.payment-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelector(`[data-method="${method}"]`).classList.add('selected');
        }

        function confirmOrder() {
            const address = {
                street: document.getElementById('street').value,
                number: document.getElementById('number').value,
                complement: document.getElementById('complement').value,
                neighborhood: document.getElementById('neighborhood').value,
                city: document.getElementById('city').value,
                state: document.getElementById('state').value,
                zipCode: document.getElementById('zipCode').value
            };

            const paymentMethod = document.querySelector('.payment-option.selected').dataset.method;
            
            // Aqui você pode adicionar a lógica para enviar o pedido para o backend
            console.log('Pedido confirmado:', {
                items: cart,
                address,
                paymentMethod
            });
            
            // Limpar o carrinho e fechar o modal
            cart = [];
            updateCartDisplay();
            closeCheckout();
            
            // Mostrar mensagem de sucesso
            alert('Pedido realizado com sucesso!');
        }

        // Função para buscar endereço pelo CEP
        async function fetchAddressByZipCode(zipCode) {
            try {
                const response = await fetch(`https://viacep.com.br/ws/${zipCode}/json/`);
                const data = await response.json();
                
                if (!data.erro) {
                    document.getElementById('street').value = data.logradouro;
                    document.getElementById('neighborhood').value = data.bairro;
                    document.getElementById('city').value = data.localidade;
                    document.getElementById('state').value = data.uf;
                }
            } catch (error) {
                console.error('Erro ao buscar endereço:', error);
            }
        }

        // Carregar produtos em destaque
        async function loadFeaturedProducts() {
            try {
                const response = await fetch('/api/products/featured');
                const products = await response.json();
                
                const slider = document.getElementById('featuredSlider');
                products.forEach(product => {
                    const productElement = document.createElement('div');
                    productElement.className = 'featured-product';
                    productElement.innerHTML = `
                        <div class="product-image">
                            <img src="${product.image}" alt="${product.name}">
                        </div>
                        <div class="product-info">
                            <h3>${product.name}</h3>
                            <p class="price">R$ ${product.price.toFixed(2)}</p>
                            <button onclick="addToCart(${JSON.stringify(product)})">Adicionar ao Carrinho</button>
                        </div>
                    `;
                    slider.appendChild(productElement);
                });
            } catch (error) {
                console.error('Erro ao carregar produtos em destaque:', error);
            }
        }

        // Carregar produtos da loja
        async function loadProducts() {
            try {
                const response = await fetch('/api/products');
                const products = await response.json();
                
                const grid = document.getElementById('productGrid');
                products.forEach(product => {
                    const productElement = document.createElement('div');
                    productElement.className = 'product-card';
                    productElement.innerHTML = `
                        <div class="product-badges">
                            ${product.isNew ? '<span class="badge new">Novo</span>' : ''}
                            ${product.onSale ? '<span class="badge sale">Promoção</span>' : ''}
                        </div>
                        <div class="product-actions">
                            <button class="action-btn" onclick="addToCart(${JSON.stringify(product)})">
                                <i class="fas fa-shopping-cart"></i>
                            </button>
                        </div>
                        <div class="product-image">
                            <img src="${product.image}" alt="${product.name}">
                        </div>
                        <div class="product-info">
                            <span class="product-category">${product.category}</span>
                            <h3 class="product-title">${product.name}</h3>
                            <div class="product-rating">
                                ${Array(5).fill().map((_, i) => 
                                    `<i class="fas fa-star${i < product.rating ? '' : '-o'}"></i>`
                                ).join('')}
                                <span>(${product.reviews})</span>
                            </div>
                            <div class="product-price">
                                ${product.originalPrice ? 
                                    `<span class="original-price">R$ ${product.originalPrice.toFixed(2)}</span>` : 
                                    ''}
                                <span class="final-price">R$ ${product.price.toFixed(2)}</span>
                            </div>
                            <p class="product-installments">
                                ${product.installments}x de R$ ${(product.price / product.installments).toFixed(2)}
                            </p>
                            <button class="add-to-cart" onclick="addToCart(${JSON.stringify(product)})">
                                <i class="fas fa-shopping-cart"></i>
                                Adicionar ao Carrinho
                            </button>
                        </div>
                    `;
                    grid.appendChild(productElement);
                });
            } catch (error) {
                console.error('Erro ao carregar produtos:', error);
            }
        }

        // Carregar produtos quando a página for carregada
        document.addEventListener('DOMContentLoaded', () => {
            loadFeaturedProducts();
            loadProducts();
        });

        // Função para filtrar produtos
        function filterProducts(filter) {
            // Atualizar botões ativos
            document.querySelectorAll('.section-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Filtrar produtos
            const products = document.querySelectorAll('.product-card');
            products.forEach(product => {
                switch(filter) {
                    case 'all':
                        product.style.display = 'block';
                        break;
                    case 'new':
                        product.style.display = product.querySelector('.badge.new') ? 'block' : 'none';
                        break;
                    case 'sale':
                        product.style.display = product.querySelector('.badge.sale') ? 'block' : 'none';
                        break;
                    case 'bestsellers':
                        // Aqui você pode implementar a lógica para mostrar os mais vendidos
                        // Por enquanto, vamos mostrar todos os produtos
                        product.style.display = 'block';
                        break;
                }
            });
        }

        // Função para buscar produtos
        function searchProducts(query) {
            const products = document.querySelectorAll('.product-card');
            const searchTerm = query.toLowerCase();
            
            products.forEach(product => {
                const title = product.querySelector('.product-title').textContent.toLowerCase();
                const category = product.querySelector('.product-category').textContent.toLowerCase();
                
                if (title.includes(searchTerm) || category.includes(searchTerm)) {
                    product.style.display = 'block';
                } else {
                    product.style.display = 'none';
                }
            });
        }

        // Adicionar evento de busca
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.querySelector('.search-bar input');
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    searchProducts(e.target.value);
                });
            }

            const categoryFilter = document.querySelector('.category-filter select');
            if (categoryFilter) {
                categoryFilter.addEventListener('change', (e) => {
                    const products = document.querySelectorAll('.product-card');
                    const selectedCategory = e.target.value.toLowerCase();
                    
                    products.forEach(product => {
                        const productCategory = product.querySelector('.product-category').textContent.toLowerCase();
                        if (selectedCategory === '' || productCategory === selectedCategory) {
                            product.style.display = 'block';
                        } else {
                            product.style.display = 'none';
                        }
                    });
                });
            }
        });
    </script>
</body>
</html> 